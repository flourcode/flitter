<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Flitter - for Bird Lovers</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <style>
    :root {
      /* Enhanced Color Palette (Based on original blue theme) */
      --primary-color: #1976D2; /* Blue 700 */
      --primary-light-color: #64B5F6; /* Blue 300 */
      --primary-dark-color: #0D47A1; /* Blue 900 */
      --accent-color: #FFC107; /* Amber 500 */
      --accent-hover: #FFB300; /* Amber 600 */
      --background-color: #f5f5f5; /* Grey 100 */
      --card-background-color: #ffffff;
      --text-color-primary: #212121; /* Grey 900 */
      --text-color-secondary: #757575; /* Grey 600 */
      --text-color-on-primary: #ffffff;
      --divider-color: #BDBDBD; /* Grey 400 */

      /* Improved Shadows */
      --shadow-dp2: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.12), 0 1px 5px 0 rgba(0, 0, 0, 0.2);
      --shadow-dp4: 0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
      --shadow-dp8: 0 8px 10px 1px rgba(0,0,0,0.14), 0 3px 14px 2px rgba(0,0,0,0.12), 0 5px 5px -3px rgba(0,0,0,0.2);

      /* Typography */
      --font-family: 'Roboto', 'Segoe UI', sans-serif;
      --font-size-base: 16px;
      --font-size-large: 1.25rem;
      --font-size-xlarge: 1.75rem;
      --font-size-small: 0.875rem;
    }

    body {
      margin: 0;
      background: var(--background-color);
      font-family: var(--font-family);
      color: var(--text-color-primary);
      font-size: var(--font-size-base);
      line-height: 1.6;
    }

    header {
      background: var(--primary-color);
      background-image: linear-gradient(to right, var(--primary-color), var(--primary-dark-color));
      color: var(--text-color-on-primary);
      padding: 1.5rem 2rem 1rem 2rem;
      text-align: center;
      box-shadow: var(--shadow-dp4);
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    .header-main-title {
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: var(--font-size-xlarge);
      font-weight: 500;
      margin-bottom: 0.5rem;
    }

    .header-main-title h1 {
      margin: 0;
      display: flex;
      align-items: center;
    }

    .header-credit {
      font-size: var(--font-size-small);
      font-weight: 300;
      color: rgba(255, 255, 255, 0.85);
      line-height: 1.2;
    }

    .header-credit .heart {
      color: #FFB6C1;
      display: inline-block;
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }

    .container {
      max-width: 1600px;
      margin: 0 auto;
      padding: 0 1rem;
    }

    #video-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 2rem;
      padding: 2rem;
      max-width: 1600px;
      margin: auto;
    }

    .video-card {
      background: var(--card-background-color);
      border-radius: 8px;
      box-shadow: var(--shadow-dp2);
      overflow: hidden;
      transition: all 0.3s cubic-bezier(.25,.8,.25,1);
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .video-card:hover {
      box-shadow: var(--shadow-dp8);
      transform: translateY(-5px);
    }

    .video-card iframe {
      width: 100%;
      height: 220px;
      border: none;
      display: block;
    }

    .video-title {
        padding: 0.75rem 1rem;
        font-size: var(--font-size-large); /* Should be 1.25rem */
        font-weight: 500;
        color: var(--text-color-primary);
        border-top: 1px solid var(--divider-color);
        
        /* Allow text to wrap, but limit to 2 lines with ellipsis */
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-line-clamp: 2; /* Show a maximum of 2 lines */
        -webkit-box-orient: vertical;
        
        /* Adjust line-height and min-height for two lines */
        line-height: 1.3; /* A reasonable line-height for titles */
        /* Calculate min-height: (lines * line-height * font-size) + padding
           Here, it's roughly for 2 lines of text.
           2 lines * 1.3 line-height = 2.6em of text height.
           Padding is 0.75rem top & 0.75rem bottom.
           If font-size is 1.25rem, then 0.75rem is 0.6em (0.75/1.25). So 1.2em total for padding.
           min-height would be 2.6em (text) + 1.2em (padding) = 3.8em
        */
        min-height: 3.8em; /* Ensures space for two lines and padding */
        /* You can also set a max-height if you want to be very strict,
           but -webkit-line-clamp usually handles the visual height. */
    }

    .loading-container {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 3rem 1rem;
      min-height: 100px;
    }

    .spinner {
      border: 5px solid rgba(100, 181, 246, 0.3);
      border-top: 5px solid var(--primary-color);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .status-message {
      text-align: center;
      padding: 2rem;
      color: var(--text-color-secondary);
      font-size: var(--font-size-large);
    }

    .video-card a:focus, .video-card iframe:focus {
      outline: 3px solid var(--accent-color);
      outline-offset: 2px;
    }

    .load-more-btn {
      display: block;
      margin: 2rem auto;
      padding: 0.75rem 1.5rem;
      background-color: var(--accent-color);
      color: var(--text-color-primary);
      border: none;
      border-radius: 4px;
      font-family: var(--font-family);
      font-size: 1rem;
      cursor: pointer;
      transition: background-color 0.3s;
      box-shadow: var(--shadow-dp2);
    }

    .load-more-btn:hover {
      background-color: var(--accent-hover);
      box-shadow: var(--shadow-dp4);
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      #video-grid {
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        padding: 1rem;
        gap: 1.5rem;
      }
    }

    @media (max-width: 480px) {
      #video-grid {
        grid-template-columns: 1fr;
      }
      
      .header-main-title {
        font-size: 1.5rem;
      }
    }
  </style>
</head>
<body>
   <header>
    <img src="flitter_logo.png" alt="Flitter App Logo" class="header-logo">
  </header>

  <div id="video-grid">
    <!-- Videos will be loaded here -->
  </div>

  <div id="loading-indicator" class="loading-container" style="display: none;">
    <div class="spinner"></div>
  </div>
  
  <div id="status-message" class="status-message" style="display: none;"></div>
  
  <button id="load-more-btn" class="load-more-btn" style="display: none;">
    Load More Bird Videos
  </button>

  <script>
    const apiKey = 'AIzaSyDQWLylWmcVw-F48vpFJMwYNq-2o09kzF4';
    let nextPageToken = '';
    const videoGrid = document.getElementById('video-grid');
    const loadingIndicator = document.getElementById('loading-indicator');
    const statusMessage = document.getElementById('status-message');
    const loadMoreBtn = document.getElementById('load-more-btn');
    let isLoading = false;
    let initialLoadDone = false;

    async function loadBirdVideos() {
      if (isLoading) return;
      isLoading = true;
      loadingIndicator.style.display = 'flex';
      statusMessage.style.display = 'none';
      loadMoreBtn.style.display = 'none';

      const searchQuery = '(live bird cam OR backyard bird watching OR peaceful garden birds) ("no ads" OR "ad free" OR "uninterrupted")';
      const maxResults = 6;

      const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=${maxResults}&type=video&q=${encodeURIComponent(searchQuery)}&videoEmbeddable=true&key=${apiKey}&pageToken=${nextPageToken}`;

      try {
        const res = await fetch(url);
        if (!res.ok) {
          const errorData = await res.json();
          throw new Error(`YouTube API Error: ${errorData.error.message || res.status}`);
        }
        const data = await res.json();

        if (data.items && data.items.length > 0) {
          nextPageToken = data.nextPageToken || '';
          data.items.forEach(item => {
            if (item.id && item.id.videoId) {
              const videoId = item.id.videoId;
              const videoTitle = item.snippet.title;

              const card = document.createElement('div');
              card.className = 'video-card';
              card.setAttribute('aria-label', `Video: ${videoTitle}`);

              card.innerHTML = `
                <iframe
                  src="https://www.youtube.com/embed/${videoId}?autoplay=0&modestbranding=1&rel=0&showinfo=0&enablejsapi=1"
                  title="${videoTitle}"
                  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                  allowfullscreen
                  loading="lazy"></iframe>
                <div class="video-title" title="${videoTitle}">${videoTitle}</div>
              `;
              videoGrid.appendChild(card);
            }
          });
          
          // Show load more button if there's a next page
          loadMoreBtn.style.display = nextPageToken ? 'block' : 'none';
        } else {
          if (!initialLoadDone) {
            statusMessage.innerText = 'No bird videos found at the moment. Please try again later.';
            statusMessage.style.display = 'block';
          } else if (!nextPageToken && initialLoadDone) {
            statusMessage.innerText = "You've reached the end of the bird videos!";
            statusMessage.style.display = 'block';
          }
        }
        initialLoadDone = true;

      } catch (e) {
        console.error('Error loading videos:', e);
        statusMessage.innerText = 'Oops! We could not load bird videos. Please check your connection or API key.';
        statusMessage.style.display = 'block';
      } finally {
        loadingIndicator.style.display = 'none';
        isLoading = false;
      }
    }

    // Initial load
    loadBirdVideos();

    // Load more button click event
    loadMoreBtn.addEventListener('click', loadBirdVideos);

    // Infinite scroll listener
    window.addEventListener('scroll', () => {
      // Load more when near the bottom, and if there's a next page token, and not currently loading
      if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight - 800 && nextPageToken && !isLoading) {
        loadBirdVideos();
      }
    });
  </script>
</body>
</html>