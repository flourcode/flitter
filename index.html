<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Birdwatching with Auntie</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <style>
    :root {
      /* Material Design Inspired Color Palette (Blue) */
      --primary-color: #1976D2; /* Blue 700 */
      --primary-light-color: #64B5F6; /* Blue 300 */
      --primary-dark-color: #0D47A1; /* Blue 900 */
      --accent-color: #FFC107; /* Amber 500 */
      --background-color: #f5f5f5; /* Grey 100 - Softer than original */
      --card-background-color: #ffffff;
      --text-color-primary: #212121; /* Grey 900 */
      --text-color-secondary: #757575; /* Grey 600 */
      --text-color-on-primary: #ffffff;
      --divider-color: #BDBDBD; /* Grey 400 */

      /* Material Design Shadows */
      --shadow-dp2: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.12), 0 1px 5px 0 rgba(0, 0, 0, 0.2);
      --shadow-dp4: 0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
      --shadow-dp8: 0 8px 10px 1px rgba(0,0,0,0.14), 0 3px 14px 2px rgba(0,0,0,0.12), 0 5px 5px -3px rgba(0,0,0,0.2);

      /* Typography */
      --font-family: 'Roboto', 'Segoe UI', sans-serif; /* Roboto is a Material Design standard */
      --font-size-base: 16px; /* Increased base font size for readability */
      --font-size-large: 1.25rem;
      --font-size-xlarge: 1.75rem;
    }

    body {
      margin: 0;
      background: var(--background-color);
      font-family: var(--font-family);
      color: var(--text-color-primary);
      font-size: var(--font-size-base);
      line-height: 1.6;
    }

    header {
      background: var(--primary-color);
      color: var(--text-color-on-primary);
      padding: 1.5rem 2rem; /* Increased padding */
      font-size: var(--font-size-xlarge); /* Larger font for header */
      font-weight: 500; /* Material Design medium weight */
      text-align: center;
      box-shadow: var(--shadow-dp4);
      position: sticky;
      top: 0;
      z-index: 1000;
      display: flex; /* For icon alignment */
      align-items: center;
      justify-content: center;
    }

    header .material-icons { /* Style for icon in header */
      font-size: 2.5rem; /* Larger icon */
      margin-right: 0.75rem;
    }

    #video-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); /* Slightly larger min card width */
      gap: 2rem; /* Increased gap */
      padding: 2rem;
      max-width: 1600px; /* Allow wider content on large screens */
      margin: auto;
    }

    .video-card {
      background: var(--card-background-color);
      border-radius: 8px; /* Consistent with Material card rounding */
      box-shadow: var(--shadow-dp2);
      overflow: hidden;
      transition: box-shadow 0.3s cubic-bezier(.25,.8,.25,1); /* Material Design animation curve */
      display: flex; /* To help with potential content inside */
      flex-direction: column;
    }

    .video-card:hover {
      box-shadow: var(--shadow-dp8);
    }

    .video-card iframe {
      width: 100%;
      height: 220px; /* Increased height for better viewing */
      border: none;
      display: block; /* Remove extra space below iframe */
    }

    /* Added placeholder for video title (optional but good for context) */
    .video-title {
        padding: 0.75rem 1rem;
        font-size: var(--font-size-large);
        font-weight: 500;
        color: var(--text-color-primary);
        border-top: 1px solid var(--divider-color);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        min-height: 2.4em; /* Ensure space even if title is short or missing */
    }


    .loading-container { /* Centered loading spinner */
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 3rem 1rem;
      min-height: 100px; /* Ensure it's visible */
    }

    /* Simple CSS Spinner */
    .spinner {
      border: 5px solid var(--primary-light-color);
      border-top: 5px solid var(--primary-dark-color);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .status-message {
        text-align: center;
        padding: 2rem;
        color: var(--text-color-secondary);
        font-size: var(--font-size-large);
    }

    /* Accessibility: Focus states for keyboard navigation */
    .video-card a:focus, .video-card iframe:focus {
        outline: 3px solid var(--accent-color);
        outline-offset: 2px;
    }

  </style>
</head>
<body>
  <header>
	<h1>üê¶ Flitter</h1>
  </header>

  <div id="video-grid">
    </div>

  <div id="loading-indicator" class="loading-container" style="display: none;">
    <div class="spinner"></div>
  </div>
  <div id="status-message" class="status-message" style="display: none;"></div>

  <script>
    // IMPORTANT: REPLACE 'YOUR_YOUTUBE_API_KEY' with your actual YouTube Data API v3 key
    const apiKey = 'AIzaSyDQWLylWmcVw-F48vpFJMwYNq-2o09kzF4'; // Original key from file
    let nextPageToken = '';
    const videoGrid = document.getElementById('video-grid');
    const loadingIndicator = document.getElementById('loading-indicator');
    const statusMessage = document.getElementById('status-message');
    let isLoading = false;
    let initialLoadDone = false;

    async function loadBirdVideos() {
      if (isLoading) return;
      isLoading = true;
      loadingIndicator.style.display = 'flex'; // Use flex for centered spinner
      statusMessage.style.display = 'none';

      // More specific search query, focusing on live feeds or calm backyard bird videos
      // Consider terms like "live bird cam backyard", "peaceful bird watching", "garden birds sounds"
      const searchQuery = 'calm backyard bird watching live OR relaxing garden birds';
      const maxResults = 6; // Reduced for less overwhelming initial load, more frequent smaller loads

      const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=${maxResults}&type=video&q=${encodeURIComponent(searchQuery)}&videoEmbeddable=true&key=${apiKey}&pageToken=${nextPageToken}`;

      try {
        const res = await fetch(url);
        if (!res.ok) {
          const errorData = await res.json();
          throw new Error(`YouTube API Error: ${errorData.error.message || res.status}`);
        }
        const data = await res.json();

        if (data.items && data.items.length > 0) {
          nextPageToken = data.nextPageToken || ''; // Ensure nextPageToken is updated or cleared
          data.items.forEach(item => {
            if (item.id && item.id.videoId) { // Ensure videoId exists
                const videoId = item.id.videoId;
                const videoTitle = item.snippet.title; // Get video title

                const card = document.createElement('div');
                card.className = 'video-card';
                card.setAttribute('aria-label', `Video: ${videoTitle}`); // Accessibility

                // Using googleusercontent.com for embedding to avoid potential youtube.com restrictions in some contexts
                // The '0' in the path might be a placeholder or specific to an internal system.
                // If direct YouTube embedding is preferred and works, use: `https://www.youtube.com/embed/${videoId}`
                card.innerHTML = `
                    <iframe
                    src="https://www.youtube.com/embed/${videoId}?autoplay=0&modestbranding=1&rel=0&showinfo=0&enablejsapi=1"
                    title="${videoTitle}"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen
                    loading="lazy"></iframe>
                    <div class="video-title" title="${videoTitle}">${videoTitle}</div>
                `;
                videoGrid.appendChild(card);
            }
          });
        } else {
          if (!initialLoadDone) { // If no videos on first load
            statusMessage.innerText = 'No bird videos found at the moment. Please try again later.';
            statusMessage.style.display = 'block';
          } else if (!nextPageToken && initialLoadDone) { // No more videos to load
             statusMessage.innerText = "You've reached the end of the bird videos!";
             statusMessage.style.display = 'block';
          }
        }
        initialLoadDone = true;

      } catch (e) {
        console.error('Error loading videos:', e);
        statusMessage.innerText = 'Oops! We could not load bird videos. Please check your connection or API key.';
        statusMessage.style.display = 'block';
      } finally {
        loadingIndicator.style.display = 'none';
        isLoading = false;
      }
    }

    // Initial load
    loadBirdVideos();

    // Infinite scroll listener
    window.addEventListener('scroll', () => {
      // Load more when near the bottom, and if there's a next page token, and not currently loading
      if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight - 800 && nextPageToken && !isLoading) {
        loadBirdVideos();
      }
    });

    // Optional: Add a button to manually load more if infinite scroll is not preferred
    // const loadMoreButton = document.createElement('button');
    // loadMoreButton.textContent = 'Load More Bird Videos';
    // loadMoreButton.onclick = loadBirdVideos;
    // loadMoreButton.style.cssText = 'display:block; margin: 2rem auto; padding: 1rem 1.5rem; font-size: 1.2rem; background-color: var(--accent-color); color: var(--text-color-primary); border:none; border-radius: 4px; box-shadow: var(--shadow-dp2); cursor:pointer;';
    // document.body.appendChild(loadMoreButton);

  </script>
</body>
</html>